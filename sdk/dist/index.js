"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class e{constructor(){this.STORAGE_KEY="web_monitor_queue",this.TIMER_KEY="web_monitor_timer",this.MAX_STORAGE_SIZE=1048576}save(e){if(!this.isLocalStorageAvailable())return!1;try{const t=JSON.stringify(e);return t.length>this.MAX_STORAGE_SIZE?(console.warn("WebMonitorSDK: Data too large for localStorage"),!1):(localStorage.setItem(this.STORAGE_KEY,t),!0)}catch(e){return console.warn("WebMonitorSDK: Failed to save to localStorage:",e),!1}}load(){if(!this.isLocalStorageAvailable())return[];try{const e=localStorage.getItem(this.STORAGE_KEY);if(!e)return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch(e){return console.warn("WebMonitorSDK: Failed to load from localStorage:",e),this.clear(),[]}}clear(){if(this.isLocalStorageAvailable())try{localStorage.removeItem(this.STORAGE_KEY)}catch(e){console.warn("WebMonitorSDK: Failed to clear localStorage:",e)}}isLocalStorageAvailable(){try{const e="__localStorage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}getStorageSize(){if(!this.isLocalStorageAvailable())return 0;try{const e=localStorage.getItem(this.STORAGE_KEY);return e?e.length:0}catch(e){return 0}}saveLastReportTime(e){if(!this.isLocalStorageAvailable())return!1;try{return localStorage.setItem(this.TIMER_KEY,e.toString()),!0}catch(e){return console.warn("WebMonitorSDK: Failed to save timer to localStorage:",e),!1}}getLastReportTime(){if(!this.isLocalStorageAvailable())return 0;try{const e=localStorage.getItem(this.TIMER_KEY);return e?parseInt(e,10):0}catch(e){return console.warn("WebMonitorSDK: Failed to load timer from localStorage:",e),0}}clearTimer(){if(this.isLocalStorageAvailable())try{localStorage.removeItem(this.TIMER_KEY)}catch(e){console.warn("WebMonitorSDK: Failed to clear timer from localStorage:",e)}}getRawData(){if(!this.isLocalStorageAvailable())return null;try{return localStorage.getItem(this.STORAGE_KEY)}catch(e){return console.warn("WebMonitorSDK: Failed to get raw data from localStorage:",e),null}}getDebugInfo(){const e=this.load(),t=this.getRawData();return{hasData:e.length>0,dataCount:e.length,storageSize:t?t.length:0,lastReportTime:this.getLastReportTime(),data:e.length>0?e:null}}logStorageData(){const e=this.getDebugInfo();if(console.group("📦 WebMonitorSDK Storage Debug Info"),console.log("📊 数据统计:"),console.log("  • 是否有数据: "+(e.hasData?"✅":"❌")),console.log(`  • 数据条数: ${e.dataCount}`),console.log(`  • 存储大小: ${(e.storageSize/1024).toFixed(2)} KB`),e.lastReportTime>0){const t=new Date(e.lastReportTime);console.log(`  • 上次上报: ${t.toLocaleString()}`)}else console.log("  • 上次上报: 暂无记录");e.data&&e.data.length>0&&(console.log("📋 存储的数据:"),e.data.forEach((e,t)=>{console.log(`  ${t+1}. [${e.type}] ${new Date(e.timestamp).toLocaleString()}`),console.log("     ",e)})),console.groupEnd()}}class t{constructor(t){var o,r,n,a,s,i,l,c,u;this.dataQueue=[],this.reportTimer=null,this.isDestroyed=!1,this.pendingRequests=0,this.retryQueue=[],this.options={url:t.url,timeout:null!==(o=t.timeout)&&void 0!==o?o:5e3,withCredentials:null!==(r=t.withCredentials)&&void 0!==r&&r,headers:null!==(n=t.headers)&&void 0!==n?n:{},reportInterval:null!==(a=t.reportInterval)&&void 0!==a?a:6e4,batchSize:null!==(s=t.batchSize)&&void 0!==s?s:10,maxQueueSize:null!==(i=t.maxQueueSize)&&void 0!==i?i:100,enableImmediateReport:null===(l=t.enableImmediateReport)||void 0===l||l,retryCount:null!==(c=t.retryCount)&&void 0!==c?c:3,retryInterval:null!==(u=t.retryInterval)&&void 0!==u?u:1e3},this.storageManager=new e,this.loadDataFromStorage(),this.startReportTimer(),this.setupBeforeUnload(),this.startRetryTimer()}loadDataFromStorage(){const e=this.storageManager.load();this.dataQueue.push(...e),this.storageManager.clear()}saveDataToStorage(){this.dataQueue.length>0&&this.storageManager.save(this.dataQueue)}startReportTimer(){const e=Date.now(),t=this.storageManager.getLastReportTime();let o=this.options.reportInterval;if(t>0){const r=e-t;o=r<this.options.reportInterval?this.options.reportInterval-r:0}o<=0&&(this.processQueuedData(),o=this.options.reportInterval),this.reportTimer=window.setInterval(()=>{this.processQueuedData()},this.options.reportInterval),o!==this.options.reportInterval&&setTimeout(()=>{this.processQueuedData()},o)}startRetryTimer(){setInterval(()=>{this.processRetryQueue()},this.options.retryInterval)}setupBeforeUnload(){window.addEventListener("beforeunload",()=>{this.saveDataToStorage(),this.flushAllQueues()}),window.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&(this.saveDataToStorage(),this.flushAllQueues())})}flushAllQueues(){this.dataQueue.length>0&&(this.trySendBeacon(this.dataQueue),this.dataQueue=[])}send(e){this.isDestroyed||(this.dataQueue.push(e),this.checkQueueOverflow())}processQueuedData(){if(this.isDestroyed||this.pendingRequests>3)return;const e=this.dataQueue.length>0;if(this.dataQueue.length>0){const e=this.dataQueue.splice(0,this.options.batchSize);this.sendBatch(e),this.storageManager.saveLastReportTime(Date.now())}e&&this.storageManager.clear()}sendBatch(e){if(this.isDestroyed)return;this.pendingRequests++;const t=JSON.stringify(e),o=this.sendFetch(t).catch(()=>this.sendXHR(t));Promise.resolve(o).then(()=>{var t;this.pendingRequests--,(null===(t=this.options.headers)||void 0===t?void 0:t.debug)&&console.log(`数据上报成功: ${e.length} 条数据`)}).catch(()=>{this.pendingRequests--,this.addToRetryQueue(e)})}trySendBeacon(e){if(!navigator.sendBeacon)return null;try{const t=JSON.stringify(e),o=new Blob([t],{type:"application/json"});return navigator.sendBeacon(this.options.url,o)?Promise.resolve():Promise.reject(new Error("SendBeacon failed"))}catch(e){return Promise.reject(e)}}checkQueueOverflow(){this.dataQueue.length>=this.options.maxQueueSize&&this.processQueuedData()}addToRetryQueue(e){const t={data:e,retryCount:0,nextRetryTime:Date.now()+this.options.retryInterval};this.retryQueue.push(t)}processRetryQueue(){if(0===this.retryQueue.length||this.pendingRequests>3)return;const e=Date.now();this.retryQueue.filter(t=>e>=t.nextRetryTime).forEach(t=>{if(t.retryCount<this.options.retryCount)t.retryCount++,t.nextRetryTime=e+this.options.retryInterval*Math.pow(2,t.retryCount),this.sendBatch(t.data);else{const e=this.retryQueue.indexOf(t);e>-1&&this.retryQueue.splice(e,1)}})}async sendFetch(e){const t=new AbortController,o=setTimeout(()=>t.abort(),this.options.timeout);try{await fetch(this.options.url,{method:"POST",headers:{"Content-Type":"application/json",...this.options.headers},body:e,credentials:this.options.withCredentials?"include":"omit",signal:t.signal})}finally{clearTimeout(o)}}sendXHR(e){const t=new XMLHttpRequest;t.open("POST",this.options.url,!0),t.timeout=this.options.timeout,t.withCredentials=this.options.withCredentials,t.setRequestHeader("Content-Type","application/json"),Object.entries(this.options.headers).forEach(([e,o])=>{t.setRequestHeader(e,o)}),t.onerror=()=>{},t.ontimeout=()=>{};try{t.send(e)}catch(e){}}destroy(){this.isDestroyed=!0,this.reportTimer&&(clearInterval(this.reportTimer),this.reportTimer=null),this.flushAllQueues(),this.retryQueue=[],this.storageManager.clearTimer()}getQueueStatus(){return{queue:this.dataQueue.length,retry:this.retryQueue.length,pending:this.pendingRequests}}flush(){this.processQueuedData()}getStorageManager(){return this.storageManager}getDebugInfo(){return{isDestroyed:this.isDestroyed,queueStatus:this.getQueueStatus(),storageInfo:this.storageManager.getDebugInfo(),options:{...this.options}}}logDebugInfo(){const e=this.getDebugInfo();if(console.group("🚀 WebMonitorSDK Transport Debug Info"),console.log("📈 传输器状态:"),console.log("  • 是否已销毁: "+(e.isDestroyed?"✅":"❌")),console.log(`  • 内存队列: ${e.queueStatus.queue} 条`),console.log(`  • 重试队列: ${e.queueStatus.retry} 条`),console.log(`  • 正在发送: ${e.queueStatus.pending} 个请求`),console.log("⚙️ 配置信息:"),console.log(`  • 上报间隔: ${e.options.reportInterval/1e3}s`),console.log(`  • 批量大小: ${e.options.batchSize} 条`),console.log(`  • 队列上限: ${e.options.maxQueueSize} 条`),console.log(`  • 重试次数: ${e.options.retryCount} 次`),console.log("💾 存储状态:"),console.log("  • 本地缓存: "+(e.storageInfo.hasData?"✅":"❌")),console.log(`  • 缓存条数: ${e.storageInfo.dataCount} 条`),console.log(`  • 缓存大小: ${(e.storageInfo.storageSize/1024).toFixed(2)} KB`),e.storageInfo.lastReportTime>0){const t=new Date(e.storageInfo.lastReportTime),o=Date.now()-e.storageInfo.lastReportTime;console.log(`  • 上次上报: ${t.toLocaleString()} (${Math.round(o/1e3)}s前)`)}console.groupEnd(),e.storageInfo.hasData&&console.log("💡 提示: 使用 monitor.transport.getStorageManager().logStorageData() 查看详细缓存数据")}}function o(e){const t=[];let o=e;for(;o&&o.nodeType===Node.ELEMENT_NODE;){let e=o.nodeName.toLowerCase();if(o.id){e+=`#${o.id}`,t.unshift(e);break}{let t=1,r=o.previousElementSibling;for(;r;)r.nodeName.toLowerCase()===e&&t++,r=r.previousElementSibling;t>1&&(e+=`:nth-child(${t})`)}t.unshift(e),o=o.parentElement}return t.join(" > ")}function r(){const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return e&&(e.effectiveType||e.type)||"unknown"}class n{constructor(e){this.breadcrumbs=[],this.plugins=new Map,this.isDestroyed=!1,this.config=this.mergeConfig(e),this.sessionId=function(){const e=localStorage.getItem("web_monitor_session_id");if(e)return e;const t=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;try{localStorage.setItem("web_monitor_session_id",t)}catch(e){}return t}(),this._transport=new t({url:this.config.reportUrl,reportInterval:this.config.reportInterval,batchSize:this.config.batchSize,maxQueueSize:this.config.maxQueueSize,enableImmediateReport:this.config.enableImmediateReport}),this.init()}mergeConfig(e){var t,o,r,n,a,s,i,l,c,u,h,p,d,m,g,f,y;return{appId:e.appId,reportUrl:e.reportUrl,sampling:null!==(t=e.sampling)&&void 0!==t?t:1,debug:null!==(o=e.debug)&&void 0!==o&&o,enablePerformance:null===(r=e.enablePerformance)||void 0===r||r,enableError:null===(n=e.enableError)||void 0===n||n,enableBehavior:null===(a=e.enableBehavior)||void 0===a||a,maxBreadcrumbsNum:null!==(s=e.maxBreadcrumbsNum)&&void 0!==s?s:20,beforeSend:null!==(i=e.beforeSend)&&void 0!==i?i:e=>e,reportInterval:null!==(l=e.reportInterval)&&void 0!==l?l:6e4,batchSize:null!==(c=e.batchSize)&&void 0!==c?c:10,maxQueueSize:null!==(u=e.maxQueueSize)&&void 0!==u?u:100,enableImmediateReport:null===(h=e.enableImmediateReport)||void 0===h||h,performance:{enableBatch:null===(d=null===(p=e.performance)||void 0===p?void 0:p.enableBatch)||void 0===d||d,batchInterval:null!==(g=null===(m=e.performance)||void 0===m?void 0:m.batchInterval)&&void 0!==g?g:5e3,batchSize:null!==(y=null===(f=e.performance)||void 0===f?void 0:f.batchSize)&&void 0!==y?y:10}}}init(){this.shouldSample()&&this.setupErrorHandling()}shouldSample(){return Math.random()<this.config.sampling}setupErrorHandling(){const e=console.error;console.error=(...t)=>{try{e.apply(console,t)}catch(e){}},window.addEventListener("error",()=>{this.safeExecute(()=>{})}),window.addEventListener("unhandledrejection",()=>{this.safeExecute(()=>{})})}safeExecute(e){try{this.isDestroyed||e()}catch(e){this.config.debug&&console.warn("WebMonitorSDK internal error:",e)}}addBreadcrumb(e){this.breadcrumbs.length>=this.config.maxBreadcrumbsNum&&this.breadcrumbs.shift(),this.breadcrumbs.push(e)}report(e){this.safeExecute(()=>{const t={appId:this.config.appId,timestamp:Date.now(),sessionId:this.sessionId,url:window.location.href,userAgent:navigator.userAgent,connectionType:r(),breadcrumbs:[...this.breadcrumbs],...e},o=this.config.beforeSend(t);o&&(this._transport.send(o),this.config.debug&&console.log("WebMonitorSDK Report:",o))})}use(e){this.plugins.has(e.name)?console.warn(`Plugin ${e.name} already installed`):(this.plugins.set(e.name,e),e.install(this))}unuse(e){const t=this.plugins.get(e);t&&t.uninstall&&t.uninstall(this),this.plugins.delete(e)}destroy(){this.isDestroyed=!0,this._transport.destroy(),this.plugins.forEach(e=>{e.uninstall&&e.uninstall(this)}),this.plugins.clear(),this.breadcrumbs=[]}get isDebug(){return this.config.debug}get appId(){return this.config.appId}get currentSessionId(){return this.sessionId}get transport(){return this._transport}getDebugInfo(){return{config:{...this.config},sessionId:this.sessionId,breadcrumbsCount:this.breadcrumbs.length,pluginCount:this.plugins.size,isDestroyed:this.isDestroyed,transportInfo:this._transport.getDebugInfo()}}logDebugInfo(){const e=this.getDebugInfo();console.group("🔍 WebMonitorSDK Debug Info"),console.log("📋 基础信息:"),console.log(`  • App ID: ${e.config.appId}`),console.log(`  • Session ID: ${e.sessionId}`),console.log("  • 是否已销毁: "+(e.isDestroyed?"✅":"❌")),console.log("⚙️ 监控配置:"),console.log("  • 调试模式: "+(e.config.debug?"✅":"❌")),console.log("  • 性能监控: "+(e.config.enablePerformance?"✅":"❌")),console.log("  • 错误监控: "+(e.config.enableError?"✅":"❌")),console.log("  • 行为监控: "+(e.config.enableBehavior?"✅":"❌")),console.log(`  • 采样率: ${(100*e.config.sampling).toFixed(1)}%`),console.log("📊 运行状态:"),console.log(`  • 面包屑: ${e.breadcrumbsCount}/${e.config.maxBreadcrumbsNum} 条`),console.log(`  • 插件数量: ${e.pluginCount} 个`),console.groupEnd(),this._transport.logDebugInfo(),console.log("💡 调试命令:"),console.log("  • 查看详细缓存: window.WebMonitorSDK.viewCache()"),console.log("  • 清空缓存: window.WebMonitorSDK.clearCache()"),console.log("  • 手动上报: window.WebMonitorSDK.flush()")}}let a=-1;const s=e=>{addEventListener("pageshow",t=>{t.persisted&&(a=t.timeStamp,e(t))},!0)},i=(e,t,o,r)=>{let n,a;return s=>{t.value>=0&&(s||r)&&(a=t.value-(n??0),(a||void 0===n)&&(n=t.value,t.delta=a,t.rating=((e,t)=>e>t[1]?"poor":e>t[0]?"needs-improvement":"good")(t.value,o),e(t)))}},l=e=>{requestAnimationFrame(()=>requestAnimationFrame(()=>e()))},c=()=>{const e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},u=()=>{const e=c();return e?.activationStart??0},h=(e,t=-1)=>{const o=c();let r="navigate";return a>=0?r="back-forward-cache":o&&(document.prerendering||u()>0?r="prerender":document.wasDiscarded?r="restore":o.type&&(r=o.type.replace(/_/g,"-"))),{name:e,value:t,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},p=new WeakMap;function d(e,t){return p.get(e)||p.set(e,new t),p.get(e)}class m{t;i=0;o=[];h(e){if(e.hadRecentInput)return;const t=this.o[0],o=this.o.at(-1);this.i&&t&&o&&e.startTime-o.startTime<1e3&&e.startTime-t.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),this.t?.(e)}}const g=(e,t,o={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const r=new PerformanceObserver(e=>{Promise.resolve().then(()=>{t(e.getEntries())})});return r.observe({type:e,buffered:!0,...o}),r}}catch{}},f=e=>{let t=!1;return()=>{t||(e(),t=!0)}};let y=-1;const v=new Set,b=()=>"hidden"!==document.visibilityState||document.prerendering?1/0:0,S=e=>{if("hidden"===document.visibilityState){if("visibilitychange"===e.type)for(const e of v)e();isFinite(y)||(y="visibilitychange"===e.type?e.timeStamp:0,removeEventListener("prerenderingchange",S,!0))}},w=()=>{if(y<0){const e=u(),t=document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter(t=>"hidden"===t.name&&t.startTime>e)[0]?.startTime;y=t??b(),addEventListener("visibilitychange",S,!0),addEventListener("prerenderingchange",S,!0),s(()=>{setTimeout(()=>{y=b()})})}return{get firstHiddenTime(){return y},onHidden(e){v.add(e)}}},R=e=>{document.prerendering?addEventListener("prerenderingchange",()=>e(),!0):e()},T=[1800,3e3],E=(e,t={})=>{R(()=>{const o=w();let r,n=h("FCP");const a=g("paint",e=>{for(const t of e)"first-contentful-paint"===t.name&&(a.disconnect(),t.startTime<o.firstHiddenTime&&(n.value=Math.max(t.startTime-u(),0),n.entries.push(t),r(!0)))});a&&(r=i(e,n,T,t.reportAllChanges),s(o=>{n=h("FCP"),r=i(e,n,T,t.reportAllChanges),l(()=>{n.value=performance.now()-o.timeStamp,r(!0)})}))})},D=[.1,.25];let I=0,B=1/0,C=0;const M=e=>{for(const t of e)t.interactionId&&(B=Math.min(B,t.interactionId),C=Math.max(C,t.interactionId),I=C?(C-B)/7+1:0)};let P;const x=()=>P?I:performance.interactionCount??0;let O=0;class _{u=[];l=new Map;m;p;v(){O=x(),this.u.length=0,this.l.clear()}L(){const e=Math.min(this.u.length-1,Math.floor((x()-O)/50));return this.u[e]}h(e){if(this.m?.(e),!e.interactionId&&"first-input"!==e.entryType)return;const t=this.u.at(-1);let o=this.l.get(e.interactionId);if(o||this.u.length<10||e.duration>t.P){if(o?e.duration>o.P?(o.entries=[e],o.P=e.duration):e.duration===o.P&&e.startTime===o.entries[0].startTime&&o.entries.push(e):(o={id:e.interactionId,entries:[e],P:e.duration},this.l.set(o.id,o),this.u.push(o)),this.u.sort((e,t)=>t.P-e.P),this.u.length>10){const e=this.u.splice(10);for(const t of e)this.l.delete(t.id)}this.p?.(o)}}}const A=e=>{const t=globalThis.requestIdleCallback||setTimeout;"hidden"===document.visibilityState?e():(e=f(e),addEventListener("visibilitychange",e,{once:!0,capture:!0}),t(()=>{e(),removeEventListener("visibilitychange",e,{capture:!0})}))},L=[200,500],$=(e,t={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;const o=w();R(()=>{"interactionCount"in performance||P||(P=g("event",M,{type:"event",buffered:!0,durationThreshold:0}));let r,n=h("INP");const a=d(t,_),l=e=>{A(()=>{for(const t of e)a.h(t);const t=a.L();t&&t.P!==n.value&&(n.value=t.P,n.entries=t.entries,r())})},c=g("event",l,{durationThreshold:t.durationThreshold??40});r=i(e,n,L,t.reportAllChanges),c&&(c.observe({type:"first-input",buffered:!0}),o.onHidden(()=>{l(c.takeRecords()),r(!0)}),s(()=>{a.v(),n=h("INP"),r=i(e,n,L,t.reportAllChanges)}))})};class k{m;h(e){this.m?.(e)}}const N=[2500,4e3],Q=[800,1800],K=e=>{document.prerendering?R(()=>K(e)):"complete"!==document.readyState?addEventListener("load",()=>K(e),!0):setTimeout(e)};var H,z,F,W;exports.DataType=void 0,(H=exports.DataType||(exports.DataType={})).PERFORMANCE="performance",H.ERROR="error",H.BEHAVIOR="behavior",exports.PerformanceType=void 0,(z=exports.PerformanceType||(exports.PerformanceType={})).LCP="LCP",z.INP="INP",z.CLS="CLS",z.FCP="FCP",z.FID="FID",z.TTFB="TTFB",z.NAVIGATION="navigation",z.RESOURCE="resource",z.API="api",z.BATCH="batch",exports.ErrorType=void 0,(F=exports.ErrorType||(exports.ErrorType={})).JS_ERROR="js_error",F.PROMISE_ERROR="promise_error",F.RESOURCE_ERROR="resource_error",F.API_ERROR="api_error",F.CUSTOM_ERROR="custom_error",exports.BehaviorType=void 0,(W=exports.BehaviorType||(exports.BehaviorType={})).CLICK="click",W.INPUT="input",W.SCROLL="scroll",W.ROUTE_CHANGE="route_change",W.PAGE_VIEW="page_view";class q{constructor(e,t){var o,r,n;this.observer=null,this.performanceQueue=[],this.batchTimer=null,this.batchInterval=5e3,this.batchSize=10,this.batchStartTime=Date.now(),this.enableBatch=!0,this.monitor=e,t&&(this.enableBatch=null===(o=t.enableBatch)||void 0===o||o,this.batchInterval=null!==(r=t.batchInterval)&&void 0!==r?r:5e3,this.batchSize=null!==(n=t.batchSize)&&void 0!==n?n:10),this.init(),this.enableBatch&&this.startBatchTimer()}init(){this.collectWebVitals(),this.collectNavigationTiming(),this.collectResourceTiming(),this.collectAPITiming()}collectWebVitals(){((e,t={})=>{R(()=>{const o=w();let r,n=h("LCP");const a=d(t,k),c=e=>{t.reportAllChanges||(e=e.slice(-1));for(const t of e)a.h(t),t.startTime<o.firstHiddenTime&&(n.value=Math.max(t.startTime-u(),0),n.entries=[t],r())},p=g("largest-contentful-paint",c);if(p){r=i(e,n,N,t.reportAllChanges);const o=f(()=>{c(p.takeRecords()),p.disconnect(),r(!0)}),a=e=>{e.isTrusted&&(A(o),removeEventListener(e.type,a,{capture:!0}))};for(const e of["keydown","click","visibilitychange"])addEventListener(e,a,{capture:!0});s(o=>{n=h("LCP"),r=i(e,n,N,t.reportAllChanges),l(()=>{n.value=performance.now()-o.timeStamp,r(!0)})})}})})(e=>{this.reportMetric({type:exports.PerformanceType.LCP,name:"LCP",value:e.value,rating:e.rating,delta:e.delta,entries:e.entries})}),$(e=>{this.reportMetric({type:exports.PerformanceType.INP,name:"INP",value:e.value,rating:e.rating,delta:e.delta,entries:e.entries})}),((e,t={})=>{const o=w();E(f(()=>{let r,n=h("CLS",0);const a=d(t,m),c=e=>{for(const t of e)a.h(t);a.i>n.value&&(n.value=a.i,n.entries=a.o,r())},u=g("layout-shift",c);u&&(r=i(e,n,D,t.reportAllChanges),o.onHidden(()=>{c(u.takeRecords()),r(!0)}),s(()=>{a.i=0,n=h("CLS",0),r=i(e,n,D,t.reportAllChanges),l(()=>r())}),setTimeout(r))}))})(e=>{this.reportMetric({type:exports.PerformanceType.CLS,name:"CLS",value:e.value,rating:e.rating,delta:e.delta,entries:e.entries})}),E(e=>{this.reportMetric({type:exports.PerformanceType.FCP,name:"FCP",value:e.value,rating:e.rating,delta:e.delta,entries:e.entries})}),((e,t={})=>{let o=h("TTFB"),r=i(e,o,Q,t.reportAllChanges);K(()=>{const n=c();n&&(o.value=Math.max(n.responseStart-u(),0),o.entries=[n],r(!0),s(()=>{o=h("TTFB",0),r=i(e,o,Q,t.reportAllChanges),r(!0)}))})})(e=>{this.reportMetric({type:exports.PerformanceType.TTFB,name:"TTFB",value:e.value,rating:e.rating,delta:e.delta,entries:e.entries})})}collectNavigationTiming(){window.addEventListener("load",()=>{setTimeout(()=>{const e=performance.getEntriesByType("navigation")[0];if(!e)return;const t={dnsLookup:e.domainLookupEnd-e.domainLookupStart,tcpConnect:e.connectEnd-e.connectStart,sslConnect:e.secureConnectionStart>0?e.connectEnd-e.secureConnectionStart:0,request:e.responseStart-e.requestStart,response:e.responseEnd-e.responseStart,domParse:e.domInteractive-e.responseEnd,domContentLoaded:e.domContentLoadedEventEnd-e.fetchStart,loadComplete:e.loadEventEnd-e.fetchStart,firstPaint:this.getFirstPaint(),firstContentfulPaint:this.getFirstContentfulPaint()};this.reportMetric({type:exports.PerformanceType.NAVIGATION,name:"Navigation Timing",value:t.loadComplete,entries:[e],navigationType:this.getNavigationType("number"==typeof e.type?e.type:0)}),this.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.PERFORMANCE,category:"navigation",message:"Page loaded",level:"info",data:t})},0)})}collectResourceTiming(){if(PerformanceObserver)try{this.observer=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{if("resource"===e.entryType){const t=e;if(t.name.includes(this.monitor.appId))return;this.reportMetric({type:exports.PerformanceType.RESOURCE,name:t.name,value:t.duration,entries:[e]}),t.duration>3e3&&this.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.PERFORMANCE,category:"resource",message:`Slow resource: ${t.name}`,level:"warning",data:{duration:t.duration,size:t.transferSize||0}})}})}),this.observer.observe({entryTypes:["resource"]})}catch(e){}}collectAPITiming(){const e=window.fetch;window.fetch=async(...t)=>{const o=performance.now(),r="string"==typeof t[0]?t[0]:t[0].url;try{const n=await e.apply(window,t),a=performance.now()-o;return this.reportMetric({type:exports.PerformanceType.API,name:r,value:a,entries:[]}),a>2e3&&this.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.PERFORMANCE,category:"api",message:`Slow API: ${r}`,level:"warning",data:{duration:a,status:n.status}}),n}catch(e){const t=performance.now()-o;throw this.reportMetric({type:exports.PerformanceType.API,name:r,value:t,entries:[]}),e}};const t=XMLHttpRequest.prototype.open,o=XMLHttpRequest.prototype.send,r=this;XMLHttpRequest.prototype.open=function(e,o,r,n,a){return this._monitor_url=o.toString(),this._monitor_startTime=performance.now(),t.call(this,e,o,null==r||r,n,a)},XMLHttpRequest.prototype.send=function(e){const t=this,n=t._monitor_startTime,a=t._monitor_url;return t.addEventListener("readystatechange",()=>{if(4===t.readyState){const e=performance.now()-n;r&&a&&(r.reportMetric({type:exports.PerformanceType.API,name:a,value:e,entries:[]}),e>2e3&&r.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.PERFORMANCE,category:"api",message:`Slow XHR: ${a}`,level:"warning",data:{duration:e,status:t.status}}))}}),o.call(this,e)}}getFirstPaint(){const e=performance.getEntriesByType("paint").find(e=>"first-paint"===e.name);return e?e.startTime:0}getFirstContentfulPaint(){const e=performance.getEntriesByType("paint").find(e=>"first-contentful-paint"===e.name);return e?e.startTime:0}getNavigationType(e){return["navigate","reload","back_forward","prerender"][e]||"unknown"}startBatchTimer(){this.batchTimer=setInterval(()=>{this.flushBatch()},this.batchInterval)}stopBatchTimer(){this.batchTimer&&(clearInterval(this.batchTimer),this.batchTimer=null)}flushBatch(){if(0===this.performanceQueue.length)return;const e=this.createBatchData();this.monitor.report({type:exports.DataType.PERFORMANCE,data:e}),this.resetBatch()}createBatchData(){const e=Date.now(),t=[...this.performanceQueue],o=this.generateSummary(t);return{type:exports.PerformanceType.BATCH,name:"Performance Metrics Batch",count:t.length,startTime:this.batchStartTime,endTime:e,metrics:t,summary:o}}generateSummary(e){const t={vitals:{},navigation:{},resources:{count:0,slowCount:0,totalSize:0},apis:{count:0,slowCount:0,avgDuration:0}};let o=[];return e.forEach(e=>{switch(e.type){case exports.PerformanceType.LCP:t.vitals.lcp=e.value;break;case exports.PerformanceType.INP:t.vitals.inp=e.value;break;case exports.PerformanceType.CLS:t.vitals.cls=e.value;break;case exports.PerformanceType.FCP:t.vitals.fcp=e.value;break;case exports.PerformanceType.TTFB:t.vitals.ttfb=e.value;break;case exports.PerformanceType.NAVIGATION:if(t.navigation.loadComplete=e.value,e.entries&&e.entries[0]){const o=e.entries[0];t.navigation.domContentLoaded=o.domContentLoadedEventEnd-o.fetchStart}break;case exports.PerformanceType.RESOURCE:if(t.resources.count++,e.value>3e3&&t.resources.slowCount++,e.entries&&e.entries[0]){const o=e.entries[0];t.resources.totalSize=(t.resources.totalSize||0)+(o.transferSize||0)}break;case exports.PerformanceType.API:t.apis.count++,e.value>2e3&&t.apis.slowCount++,o.push(e.value)}}),o.length>0&&(t.apis.avgDuration=o.reduce((e,t)=>e+t,0)/o.length),t}resetBatch(){this.performanceQueue=[],this.batchStartTime=Date.now()}reportMetric(e){this.enableBatch?(this.performanceQueue.push(e),this.performanceQueue.length>=this.batchSize&&this.flushBatch()):this.monitor.report({type:exports.DataType.PERFORMANCE,data:e})}flush(){this.enableBatch&&this.flushBatch()}setBatchOptions(e){const t=this.enableBatch;void 0!==e.enableBatch&&(this.enableBatch=e.enableBatch),void 0!==e.batchInterval&&(this.batchInterval=e.batchInterval),void 0!==e.batchSize&&(this.batchSize=e.batchSize),t!==this.enableBatch?this.enableBatch?(this.performanceQueue.length>0&&this.flushBatch(),this.startBatchTimer()):(this.stopBatchTimer(),this.performanceQueue.length>0&&this.flushBatch()):this.enableBatch&&this.batchTimer&&(this.stopBatchTimer(),this.startBatchTimer())}getBatchStatus(){return{enabled:this.enableBatch,queueLength:this.performanceQueue.length,batchInterval:this.batchInterval,batchSize:this.batchSize,startTime:this.batchStartTime}}destroy(){this.stopBatchTimer(),this.enableBatch&&this.performanceQueue.length>0&&this.flushBatch(),this.observer&&(this.observer.disconnect(),this.observer=null),this.performanceQueue=[]}}class U{constructor(e){this.monitor=e,this.originalFetch=window.fetch,this.originalXHROpen=XMLHttpRequest.prototype.open,this.originalXHRSend=XMLHttpRequest.prototype.send,this.init()}init(){this.handleJSError(),this.handlePromiseError(),this.handleResourceError(),this.handleAPIError()}handleJSError(){window.addEventListener("error",e=>{const{message:t,filename:o,lineno:r,colno:n,error:a}=e,s={type:exports.ErrorType.JS_ERROR,message:t||"Unknown error",filename:o,lineno:r,colno:n,stack:null==a?void 0:a.stack};this.reportError(s),this.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.ERROR,category:"javascript",message:`JS Error: ${t}`,level:"error",data:{filename:o,lineno:r,colno:n}})},!0)}handlePromiseError(){window.addEventListener("unhandledrejection",e=>{let t="Unhandled Promise Rejection",o="";if(e.reason)if(e.reason instanceof Error)t=e.reason.message,o=e.reason.stack||"";else if("string"==typeof e.reason)t=e.reason;else try{t=JSON.stringify(e.reason)}catch(o){t=String(e.reason)}const r={type:exports.ErrorType.PROMISE_ERROR,message:t,stack:o};this.reportError(r),this.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.ERROR,category:"promise",message:`Promise Error: ${t}`,level:"error",data:{reason:e.reason}})})}handleResourceError(){window.addEventListener("error",e=>{const t=e.target;if(t&&t!==window&&("IMG"===t.tagName||"SCRIPT"===t.tagName||"LINK"===t.tagName||"AUDIO"===t.tagName||"VIDEO"===t.tagName)){const e={type:exports.ErrorType.RESOURCE_ERROR,message:`Resource load error: ${t.tagName}`,resourceUrl:t.src||t.href||"",elementSelector:o(t)};this.reportError(e),this.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.ERROR,category:"resource",message:`Resource Error: ${t.tagName}`,level:"error",data:{url:e.resourceUrl,element:t.tagName}})}},!0)}handleAPIError(){window.fetch=async(...e)=>{const t="string"==typeof e[0]?e[0]:e[0].url,o=Date.now();try{const r=await this.originalFetch.apply(window,e);if(!r.ok){const e={type:exports.ErrorType.API_ERROR,message:`API Error: ${r.status} ${r.statusText}`,resourceUrl:t,statusCode:r.status};this.reportError(e),this.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.ERROR,category:"api",message:`API Error: ${t}`,level:"error",data:{status:r.status,statusText:r.statusText,duration:Date.now()-o}})}return r}catch(e){const r={type:exports.ErrorType.API_ERROR,message:`Network Error: ${e instanceof Error?e.message:"Unknown error"}`,resourceUrl:t,stack:e instanceof Error?e.stack:void 0};throw this.reportError(r),this.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.ERROR,category:"api",message:`Network Error: ${t}`,level:"error",data:{error:e instanceof Error?e.message:String(e),duration:Date.now()-o}}),e}};const e=this;XMLHttpRequest.prototype.open=function(t,o,r,n,a){return this._monitor_url=o.toString(),this._monitor_method=t,this._monitor_startTime=Date.now(),e.originalXHROpen.call(this,t,o,null==r||r,n,a)},XMLHttpRequest.prototype.send=function(t){const o=this,r=o._monitor_url,n=o._monitor_method,a=o._monitor_startTime;return o.addEventListener("error",()=>{const t={type:exports.ErrorType.API_ERROR,message:`XMLHttpRequest Error: ${n} ${r}`,resourceUrl:r,statusCode:o.status};e.reportError(t),e.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.ERROR,category:"api",message:`XHR Error: ${n} ${r}`,level:"error",data:{method:n,status:o.status,duration:Date.now()-a}})}),o.addEventListener("load",()=>{if(o.status>=400){const t={type:exports.ErrorType.API_ERROR,message:`API Error: ${o.status} ${o.statusText}`,resourceUrl:r,statusCode:o.status};e.reportError(t),e.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.ERROR,category:"api",message:`XHR ${o.status}: ${n} ${r}`,level:"error",data:{method:n,status:o.status,statusText:o.statusText,duration:Date.now()-a}})}}),e.originalXHRSend.call(this,t)}}reportError(e){this.monitor.report({type:exports.DataType.ERROR,data:e})}reportCustomError(e,t){const o={type:exports.ErrorType.CUSTOM_ERROR,message:e,stack:(new Error).stack,...t};this.reportError(o),this.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.ERROR,category:"custom",message:`Custom Error: ${e}`,level:"error",data:t})}destroy(){window.fetch=this.originalFetch,XMLHttpRequest.prototype.open=this.originalXHROpen,XMLHttpRequest.prototype.send=this.originalXHRSend}}class V{constructor(e){this.monitor=e,this.currentUrl=window.location.href,this.startTime=Date.now(),this.init()}init(){this.trackPageView(),this.trackClicks(),this.trackInputs(),this.trackScrolls(),this.trackRouteChanges()}trackPageView(){const e={type:exports.BehaviorType.PAGE_VIEW,url:this.currentUrl};this.reportBehavior(e),this.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.BEHAVIOR,category:"navigation",message:`Page view: ${this.currentUrl}`,level:"info",data:{url:this.currentUrl,referrer:document.referrer}})}trackClicks(){document.addEventListener("click",e=>{const t=e.target;if(!t)return;const r={type:exports.BehaviorType.CLICK,element:t.tagName,selector:o(t),text:(n=t,"INPUT"===n.tagName?n.value||n.placeholder||"":(null===(a=n.textContent)||void 0===a?void 0:a.trim().slice(0,100))||"")};var n,a;this.reportBehavior(r),this.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.BEHAVIOR,category:"interaction",message:`Click: ${t.tagName}`,level:"info",data:{text:r.text,selector:r.selector}})},!0)}trackInputs(){const e=function(e,t){let o=null;return function(...r){const n=this;o&&clearTimeout(o),o=window.setTimeout(()=>{e.apply(n,r),o=null},t)}}(e=>{const t=e.target;if(!t||"password"===t.type)return;const r={type:exports.BehaviorType.INPUT,element:t.tagName,selector:o(t),text:"password"===t.type?"***":t.value.slice(0,100)};this.reportBehavior(r),this.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.BEHAVIOR,category:"interaction",message:`Input: ${t.tagName}`,level:"info",data:{type:t.type,selector:r.selector}})},500);document.addEventListener("input",e,!0),document.addEventListener("change",e,!0)}trackScrolls(){let e=0;const t=function(e,t){let o=null,r=0;return function(...n){const a=Date.now(),s=this;a-r>t?(e.apply(s,n),r=a):(o&&clearTimeout(o),o=window.setTimeout(()=>{e.apply(s,n),r=Date.now(),o=null},t-(a-r)))}}(()=>{const t=window.pageYOffset||document.documentElement.scrollTop,o=window.innerHeight,r=document.documentElement.scrollHeight,n=Math.round((t+o)/r*100);if(n>e&&(e=n,n>=25&&n%25==0)){const e={type:exports.BehaviorType.SCROLL,text:`${n}%`};this.reportBehavior(e),this.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.BEHAVIOR,category:"interaction",message:`Scroll: ${n}%`,level:"info",data:{depth:n,scrollTop:t,documentHeight:r}})}},1e3);window.addEventListener("scroll",t,{passive:!0})}trackRouteChanges(){const e=history.pushState,t=history.replaceState,o=(e,t)=>{const o=Date.now()-this.startTime,r={type:exports.BehaviorType.ROUTE_CHANGE,from:e,to:t,duration:o};this.reportBehavior(r),this.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.BEHAVIOR,category:"navigation",message:`Route change: ${e} -> ${t}`,level:"info",data:{from:e,to:t,duration:o}}),this.currentUrl=t,this.startTime=Date.now()};history.pushState=function(t,r,n){const a=window.location.href,s=e.apply(this,arguments),i=window.location.href;return a!==i&&o(a,i),s},history.replaceState=function(e,r,n){const a=window.location.href,s=t.apply(this,arguments),i=window.location.href;return a!==i&&o(a,i),s},window.addEventListener("popstate",()=>{const e=window.location.href;o(this.currentUrl,e)}),window.addEventListener("hashchange",()=>{const e=window.location.href;o(this.currentUrl,e)})}reportCustomBehavior(e,t){const o={type:e,...t};this.reportBehavior(o),this.monitor.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.BEHAVIOR,category:"custom",message:`Custom behavior: ${e}`,level:"info",data:t})}reportBehavior(e){this.monitor.report({type:exports.DataType.BEHAVIOR,data:e})}destroy(){}}const X={name:"vue",install(e){if("undefined"!=typeof window&&window.Vue){window.Vue.config.errorHandler=(t,o,r)=>{var n,a;const s={type:exports.ErrorType.JS_ERROR,message:t.message,stack:t.stack,source:`Vue ${r}`,filename:(null===(n=null==o?void 0:o.$options)||void 0===n?void 0:n.__file)||"Vue Component"};e.report({type:exports.DataType.ERROR,data:s}),e.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.ERROR,category:"vue",message:`Vue Error: ${t.message}`,level:"error",data:{info:r,component:(null===(a=null==o?void 0:o.$options)||void 0===a?void 0:a.name)||"Anonymous Component"}})}}if("undefined"!=typeof window&&window.Vue&&window.Vue.version&&window.Vue.version.startsWith("3")){window.Vue.createApp({}).config.errorHandler=(t,o,r)=>{var n,a;const s={type:exports.ErrorType.JS_ERROR,message:t.message,stack:t.stack,source:`Vue3 ${r}`,filename:(null===(n=null==o?void 0:o.$options)||void 0===n?void 0:n.__file)||"Vue3 Component"};e.report({type:exports.DataType.ERROR,data:s}),e.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.ERROR,category:"vue3",message:`Vue3 Error: ${t.message}`,level:"error",data:{info:r,component:(null===(a=null==o?void 0:o.type)||void 0===a?void 0:a.name)||"Anonymous Component"}})}}}},G={name:"react",install(e){if("undefined"!=typeof window&&window.React){const t=window.React.createElement;window.React.createElement=function(o,r,...n){if("function"==typeof o&&o.prototype&&o.prototype.isReactComponent){const t=o.prototype.componentDidCatch;o.prototype.componentDidCatch=function(r,n){const a={type:exports.ErrorType.JS_ERROR,message:r.message,stack:r.stack,source:"React Component",filename:n.componentStack};e.report({type:exports.DataType.ERROR,data:a}),e.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.ERROR,category:"react",message:`React Error: ${r.message}`,level:"error",data:{componentStack:n.componentStack,component:o.name||"Anonymous Component"}}),t&&t.call(this,r,n)}}return t.apply(this,arguments)}}if("undefined"!=typeof window&&window.ReactDOM&&window.ReactDOM.createRoot){const t=window.ReactDOM.createRoot;window.ReactDOM.createRoot=function(o,r={}){const n={...r,onRecoverableError:(t,o)=>{const n={type:exports.ErrorType.JS_ERROR,message:t.message,stack:t.stack,source:"React Recoverable Error"};e.report({type:exports.DataType.ERROR,data:n}),e.addBreadcrumb({timestamp:Date.now(),type:exports.DataType.ERROR,category:"react",message:`React Recoverable Error: ${t.message}`,level:"warning",data:o}),r.onRecoverableError&&r.onRecoverableError(t,o)}};return t.call(this,o,n)}}}};class J{constructor(e){this.isInitialized=!1,/bot|crawler|spider|crawling/i.test(navigator.userAgent)?this.monitor={}:(this.monitor=new n(e),this.init(),window.__webMonitorSDK=this,this.setupGlobalDebugMethods())}init(){var e,t,o;if(this.isInitialized)console.warn("WebMonitorSDK already initialized");else try{if(this.monitor.config.enablePerformance){const r=this.monitor.config.performance;this.performanceMonitor=new q(this.monitor,{enableBatch:null===(e=null==r?void 0:r.enableBatch)||void 0===e||e,batchInterval:null!==(t=null==r?void 0:r.batchInterval)&&void 0!==t?t:5e3,batchSize:null!==(o=null==r?void 0:r.batchSize)&&void 0!==o?o:10})}this.monitor.config.enableError&&(this.errorMonitor=new U(this.monitor)),this.monitor.config.enableBehavior&&(this.behaviorMonitor=new V(this.monitor)),this.isInitialized=!0,this.monitor.isDebug&&console.log("WebMonitorSDK initialized successfully")}catch(e){console.error("Failed to initialize WebMonitorSDK:",e)}}reportError(e,t){this.errorMonitor&&this.errorMonitor.reportCustomError(e,t)}reportBehavior(e,t){this.behaviorMonitor&&this.behaviorMonitor.reportCustomBehavior(e,t)}report(e){this.monitor.report(e)}use(e){return this.monitor.use(e),this}unuse(e){return this.monitor.unuse(e),this}setTag(e,t){this.monitor.tags||(this.monitor.tags={}),this.monitor.tags[e]=t}setContext(e,t){this.monitor.contexts||(this.monitor.contexts={}),this.monitor.contexts[e]=t}destroy(){var e,t,o;this.isInitialized&&(null===(e=this.performanceMonitor)||void 0===e||e.destroy(),null===(t=this.errorMonitor)||void 0===t||t.destroy(),null===(o=this.behaviorMonitor)||void 0===o||o.destroy(),this.monitor.destroy(),this.isInitialized=!1,delete window.__webMonitorSDK,this.monitor.isDebug&&console.log("WebMonitorSDK destroyed"))}getConfig(){return this.monitor.config}getSessionId(){return this.monitor.currentSessionId}flushPerformance(){this.performanceMonitor&&this.performanceMonitor.flush()}setPerformanceBatchOptions(e){this.performanceMonitor&&this.performanceMonitor.setBatchOptions(e)}getPerformanceBatchStatus(){return this.performanceMonitor?this.performanceMonitor.getBatchStatus():null}setupGlobalDebugMethods(){window.WebMonitorSDK={debug:()=>{this.monitor.logDebugInfo()},viewCache:()=>{this.monitor.transport.getStorageManager().logStorageData()},clearCache:()=>{this.monitor.transport.getStorageManager().clear(),console.log("✅ 本地缓存已清空")},flush:()=>{this.monitor.transport.flush(),console.log("🚀 已手动触发数据上报")},getStatus:()=>{const e=this.monitor.transport.getQueueStatus();return console.table(e),e},getRawData:()=>{const e=this.monitor.transport.getStorageManager().getRawData();return e?(console.log("📄 原始localStorage数据:"),console.log(e),JSON.parse(e)):(console.log("❌ 没有存储数据"),null)},getDebugInfo:()=>this.monitor.getDebugInfo(),performance:{flush:()=>{this.flushPerformance(),console.log("🚀 已手动刷新性能监控数据")},getStatus:()=>{const e=this.getPerformanceBatchStatus();return e?(console.table(e),e):(console.log("❌ 性能监控未启用"),null)},setBatch:e=>{this.setPerformanceBatchOptions(e),console.log("⚙️ 性能监控批量配置已更新:",e)},disableBatch:()=>{this.setPerformanceBatchOptions({enableBatch:!1}),console.log("❌ 性能监控批量模式已禁用")},enableBatch:()=>{this.setPerformanceBatchOptions({enableBatch:!0}),console.log("✅ 性能监控批量模式已启用")}},help:()=>{console.group("🔧 WebMonitorSDK 调试命令"),console.log("基础命令:"),console.log("  WebMonitorSDK.debug()         - 查看完整调试信息"),console.log("  WebMonitorSDK.viewCache()     - 查看详细缓存数据"),console.log("  WebMonitorSDK.clearCache()    - 清空本地缓存"),console.log("  WebMonitorSDK.flush()         - 手动触发数据上报"),console.log("  WebMonitorSDK.getStatus()     - 获取队列状态"),console.log("  WebMonitorSDK.getRawData()    - 查看原始localStorage数据"),console.log("  WebMonitorSDK.getDebugInfo()  - 获取调试信息对象"),console.log(""),console.log("性能监控命令:"),console.log("  WebMonitorSDK.performance.flush()        - 刷新性能数据"),console.log("  WebMonitorSDK.performance.getStatus()    - 获取性能批量状态"),console.log("  WebMonitorSDK.performance.setBatch(opts) - 设置批量配置"),console.log("  WebMonitorSDK.performance.enableBatch()  - 启用批量模式"),console.log("  WebMonitorSDK.performance.disableBatch() - 禁用批量模式"),console.log(""),console.log("  WebMonitorSDK.help()          - 显示此帮助信息"),console.groupEnd()}},this.monitor.isDebug&&(console.log("🔧 WebMonitorSDK 调试模式已启用"),console.log("💡 使用 WebMonitorSDK.help() 查看可用的调试命令"))}}exports.ReactPlugin=G,exports.VuePlugin=X,exports.WebMonitorSDK=J,exports.createWebMonitorSDK=function(e){return new J(e)},exports.default=J;
